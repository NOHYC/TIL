# 지도학습 분석기법(Supervised Learnig)

## 의사결정나무( Decision tree)

- 의사결정규칙(decision rule)을 나무 구조로 도표화하여 **분류**(classification)와 예측(prediction)을 수행하는 분석 방법

- 적용 분야

  > 은행 대출 : 도산 업체 분류(예측)
  >
  > 카드발급 대상 : 신용 불량자 분류(예측)
  >
  > 통신 : 이탈 고객 분류, 새로운 서비스 대상 고객 선정
  >
  > 쇼핑 : Direct Mailing 대상 고객 선정



#### 분류나무의 장점

- 지도학습(분류 및 예측)의 데이터 마이닝 기법
- 적용 결과에 의해 if - then으로 표현되는 규칙이 생성
- 규칙의 이해가 쉽고 SQL과 같은 DB 언어로 표현
- 좋은 해석력으로 널리 쓰임
- 많은 분야에서는 결정을 내리게 된 이유를 설명하는 능력이 중요함(해석력)
  - 예 : 은행의 대출 심사 결과 부적격 판정이 나온 경우 고객에게 부적격 이류를 설명해야함



![image-20200923222929061](C:\Users\nyc15\AppData\Roaming\Typora\typora-user-images\image-20200923222929061.png)



어느 규칙이 가장 중요한 규칙인지 알아야 함

규칙(rule)을 어디까지 쓸지 정해야 한다. 



#### 분류나무

- 목표변수 : 범주형(categorical target) - 좋음, 나쁨
- 분류 알고리즘과 순수도 지표 ( 얼마만큼 그룹을 정확하게 나눠줄 수 있는지 숫자로 표현 )
  - CART : 지니 지수(Gini index)
  - C4.5 : 엔트로피 지수(Entropy index)
  - CHAID : 카이제곱 통계량(Chi - Square static)



#### 회기나무

- 목표변수 : 연속 변수(Continuous Variables) - 총구매액, 매출액
- 분류 알고리즘 : CART
- 분산의 감소량
- F 통계량
- 목표변수의 평균에 기초하여 분리
- 분리의 경계점 근방에서는 예측 오류가 클 가능성



#### 의사결정 나무의 구성 원리

- 일정기준(나무의 최종 node 수 , 자료 수, 나무의 깊이)에 의해 나무의 모양이 결정
- 의사결정 트리의 가지 분리방법(split), 잘라내기(Prune) 방법에 따라 CHAID, CART, C4.5, QUEST 등 여러가지 알고리즘이 사용
- 분리기준 : 순수도(Purity), 불순도(Impurity) 기준
- 정지규칙 : 더 이상 분리가 일어나지 않고 현재의 마디가 끝마디가 되도록하는 규칙
- 잘라내기 : 지나치게 많은 마디를 가지는 의사결정나무는 새로운 자료에 적용될 때 예측 오차가 매우 클 가능성



#### 의사결정나무분석의 과정



1. 의사결정 나무의 형성
   - 분석의 목적과 자료구조에 따라서 적절한 분리기준과 정지규칙을 지정하여 의사결정 나무를 생성
2. 가지치기
   - 분류오류를 크게 할 위험이 높거나 부적절한 추론규칙을 가지고 있는 가지 제거
3. 타당성 평가
   - 이익도표나 위험 도표 또는 검증용 자료에 의한 교차 타당성 등을 이용하여 의사 결정 나무 평가
4. 해석 및 예측
   - 의사결정 나무를 해석하고 예측모형 설정

![image-20200923224954705](C:\Users\nyc15\AppData\Roaming\Typora\typora-user-images\image-20200923224954705.png)

- 대부분 이지분리( 바이너리 split ) - YES / NO